<p id="notice"><%= notice %></p>
	<%= @trackerObject %>
	<% @tracker["info"].each do |info|%>
		Latitude: <%= info["latitude"] %>
		Longitude: <%= info["longitude"] %>
	<% end %><br>
<div class="row">
	<div class="col-sm-12 col-md-2 col-lg-2" style="overflow:auto; height:500px;">
		<strong>Trackid:</strong>
		<div>
			<% @tracker["info"].each do |info|%>
				Device Number: <%= info["device_id"] %>
				Speed: <%= info["speed"] %>
				Height Above Sea: <%= info["height_above_sea"] %>
				Last Seen: <%= info["updated_at"] %>
			<% end %>
		</div>	
	</div>
	<!-- Display Google Map Here -->
	<div style='width: 800px;' class="col-sm-12 col-md-10 col-lg-10">
	  <div id="map" style='width: 1000px; height: 500px; /*img { max-width: none;*/ }'></div>
	</div>
</div>


<script type="text/javascript">
  handler = Gmaps.build('Google');
  handler.buildMap({ provider: {disableDefaultUI: true, autoZoom: true}, internal: {id: 'map'}}, function(){
    markers = handler.addMarkers(<%=raw @hash.to_json %>);
    // handler.bounds.extendWith(markers);
    handler.map.centerOn(markers[0]);
    $( document ).ready(function() { 
      setInterval(function(){
          $(function () {
              $.ajax({
                url:"/single_device/",
                dataType:'json',
                data: {id: <%=raw params[:id] %>},
                success: function(data){
                  var results = data;
                  results[0].lat = "11.833333";
                  results[0].lng = "13.150000"; 
                  console.log(results[0].lat);                                  
                  markers[0].setMap(null);
                  handler.removeMarkers(markers);
                  markers = [];
                  markers = handler.addMarkers(results);  
                  handler.map.centerOn(markers[0]);                      
                }
              })
          });
        }, 30000);  
        handler.getMap().setZoom(18);  
    });
  });  
</script>

 
